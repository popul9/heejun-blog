---
import { getLangFromUrl, getLocalizedPathname } from "../i18n/utils";

const lang = getLangFromUrl(Astro.url);
const path = Astro.url.pathname;

// Since there are only two languages, link directly to the other one
const targetLang = lang === "ko" ? "en" : "ko";
const targetUrl = getLocalizedPathname(path, targetLang);
const targetLabel = targetLang === "ko" ? "한글" : "ENG";
---

<a
    href={targetUrl}
    class="floating-lang-toggle"
    aria-label={`Switch to ${targetLang === "ko" ? "Korean" : "English"}`}
>
    <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        class="globe-icon"
    >
        <circle
            cx="12"
            cy="12"
            r="10"
            fill="none"
            stroke="#ffffff"
            stroke-width="1.8"
            stroke-linecap="round"
            stroke-linejoin="round"></circle>
        <path
            d="M2 12h20"
            fill="none"
            stroke="#ffffff"
            stroke-width="1.8"
            stroke-linecap="round"
            stroke-linejoin="round"></path>
        <path
            d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"
            fill="none"
            stroke="#ffffff"
            stroke-width="1.8"
            stroke-linecap="round"
            stroke-linejoin="round"></path>
    </svg>
    <span class="toggle-label">{targetLabel}</span>
</a>

<style is:global>
    .floating-lang-toggle {
        position: fixed;
        bottom: 2rem;
        right: 2rem;
        z-index: 9999;
        display: flex !important;
        align-items: center;
        gap: 0.4rem;
        padding: 0.55rem 0.9rem;
        border-radius: 999px;
        background: #222939 !important;
        color: #ffffff !important;
        text-decoration: none !important;
        font-size: 0.85rem;
        font-weight: 600;
        letter-spacing: 0.02em;
        box-shadow: 0 4px 14px rgba(0, 0, 0, 0.25),
            0 1px 3px rgba(0, 0, 0, 0.15);
        cursor: pointer;
        user-select: none;
        -webkit-tap-highlight-color: transparent;
        box-sizing: border-box;
    }

    .floating-lang-toggle:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3), 0 2px 6px rgba(0, 0, 0, 0.15);
    }

    .floating-lang-toggle:active {
        transform: translateY(0) scale(0.97);
    }

    .floating-lang-toggle .globe-icon {
        width: 20px;
        height: 20px;
        flex-shrink: 0;
        display: block;
    }

    .floating-lang-toggle .toggle-label {
        line-height: 1;
        color: #ffffff;
        font-size: 0.85rem;
        font-weight: 600;
    }

    @media (max-width: 720px) {
        .floating-lang-toggle {
            bottom: 1.25rem;
            right: 1.25rem;
            padding: 0.5rem 0.75rem;
            font-size: 0.8rem;
        }

        .floating-lang-toggle .globe-icon {
            width: 17px;
            height: 17px;
        }

        .floating-lang-toggle .toggle-label {
            font-size: 0.8rem;
        }
    }
</style>
